<!DOCTYPE html>
<html>
    <head>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    </head>
    <body>
        <h1>Track Roll-Over Protection</h1>
        <p>Aceleration:</p>
        <p id="Ax"></p>
        <p id="Ay"></p>
        <p id="Az"></p>
        <p>Gyroscope:</p>
        <p id="Gx"></p>
        <p id="Yy"></p>
        <p id="Gz"></p>

        <script>
            $(document).ready(function(){
                //alert('Document Ready');
                if (!('Accelerometer' in window)) {
                    // The `Accelerometer` interface is not supported by the browser.
                    alert('Aceleromter not supported in this device');
                    console.log('Aceleromter not supported in this device');

                    let accelerometer = null;
                    try {
                        // Accelerometer
                        accelerometer = new Accelerometer({ frequency: 10 });
                        accelerometer.onerror = (event) => {
                            // Handle runtime errors.
                            if (event.error.name === 'NotAllowedError') {
                            console.log('Permission to access accelerometer was denied.');
                            } else if (event.error.name === 'NotReadableError') {
                            console.log('Cannot connect to the accelerometer.');
                            }
                        };
                        accelerometer.onreading = (e) => {
                            //console.log(e);
                            //alert(JSON.stringify(e));
                            $('#Ax').text(`Ax: ${accelerometer.x.toFixed(2)} m/s^2`);
                            $('#Ay').text(`Ay: ${accelerometer.y.toFixed(2)} m/s^2`);
                            $('#Az').text(`Az: ${accelerometer.z.toFixed(2)} m/s^2`);
                        };
                        // Start accelerometer
                        accelerometer.start();

                        // Gyroscope
                        gyroscope = new gyroscope({ frequency: 10 });
                        gyroscope.onerror = (event) => {
                            // Handle runtime errors.
                            if (event.error.name === 'NotAllowedError') {
                            console.log('Permission to access gyroscope was denied.');
                            } else if (event.error.name === 'NotReadableError') {
                            console.log('Cannot connect to the gyroscope.');
                            }
                        };
                        gyroscope.onreading = (e) => {
                            //console.log(e);
                            //alert(JSON.stringify(e));
                            $('#Gx').text(`Ax: ${gyroscope.x.toFixed(2)} rad/s`);
                            $('#Gy').text(`Ay: ${gyroscope.y.toFixed(2)} rad/s`);
                            $('#Gz').text(`Az: ${gyroscope.z.toFixed(2)} rad/s`);
                        };
                        // Start accelerometer
                        gyroscope.start();





                    } catch (error) {
                        // Handle construction errors.
                        if (error.name === 'SecurityError') {
                            console.log('Sensor construction was blocked by the Permissions Policy.');
                        } else if (error.name === 'ReferenceError') {
                            console.log('Sensor is not supported by the User Agent.');
                        } else {
                            throw error;
                        }
                    }

                }
            });           

            
        </script>
    </body>
</html>
